{
  "_doc": "Modular Dzine prompt system. Fixed blocks never change. Variable blocks swap 1 axis per day. Paste assembled prompt into 'Character action & scene'.",
  "version": 3,

  "fixed_blocks": {
    "core_identity": "Ray (use the existing Ray character identity and the verified face reference). Same exact person, same facial structure, same hairline, same beard shape, same nose and jaw proportions. Do NOT change facial structure. No alternate identity. No hairstyle changes. No beard length changes. No age changes. Medium close-up talking head. Neutral expression only. No smile. No grimace. Looking directly into the camera lens. Mouth closed, relaxed lips, clean continuous lip line for lip-sync; no teeth silhouettes; no lip shadow breaks. Clean jawline and chin contour, no shadow artifacts.",
    "camera": "Eye-level camera, centered framing, stable composition, headroom 8-10%. 85mm lens look (no wide angle), natural perspective, no facial distortion. No wide-angle distortion. No 35mm look. No fisheye. Shoulders relaxed. Hands out of frame.",
    "lighting": "Soft key light from front-left 45 degrees, gentle fill from front-right, subtle rim light for separation. Neutral face light. No colored cast on skin. No extreme shadows under nose/lips. Skin tone unchanged. No harsh shadows under nose/lips/chin.",
    "quality": "Clean cinematic realism. Natural skin texture, consistent pores, stable features across generations, clean background bokeh. No plastic skin. No waxy face.",
    "negative": "open mouth, teeth showing, teeth shadow, teeth silhouettes, exaggerated smile, distorted lips, double chin artifacts, messy beard noise, hairstyle change, beard length change, age change, sunglasses, hat, heavy wrinkles, low-res, oversharpen, cartoon, anime, CGI, hands visible, extra fingers, text, logos, busy background, patterned clothing, blue skin tint, cyan cast on face, color spill, lip shadow breaks, mouth seam artifacts, asymmetrical lips, warped philtrum, stretched jaw, muddy skin, oversharpened pores, plastic skin, waxy face, wide-angle distortion, fisheye."
  },

  "variable_blocks": {
    "environment": {
      "A_office_a": "Modern minimalist tech office, blurred glass partitions, soft daylight, subtle bokeh, no readable text, no logos, neutral professional vibe.",
      "B_office_b": "Same office style, but background with blurred window + faint city lights bokeh, still minimal, no readable text, no logos.",
      "C_studio": "Professional studio backdrop, deep charcoal grey gradient, clean, non-distracting, subtle bokeh."
    },
    "outfit": {
      "1_black_tee": "Solid black crew-neck t-shirt, premium cotton, no logos, no patterns.",
      "2_navy_tee": "Solid dark navy crew-neck t-shirt, premium cotton, no logos, no patterns.",
      "3_grey_hoodie": "Solid dark grey hoodie, minimal, no logos, no drawstrings visible."
    },
    "accent": {
      "1_warm": "Background ambient slightly warm, face lighting remains neutral.",
      "2_cool": "Background ambient slightly cool, face lighting remains neutral.",
      "3_rim": "Very subtle rim light tint only, face lighting neutral."
    }
  },

  "assembly_order": [
    "core_identity",
    "camera",
    "lighting",
    "{environment}",
    "{outfit}",
    "{accent}",
    "quality",
    "NEGATIVE: {negative}"
  ],

  "daily_rotation": {
    "_doc": "Change max 1 axis per day. Default safe config: C_studio + 1_black_tee + 1_warm.",
    "max_axes_per_day": 1,
    "seeds_per_attempt": 3
  },

  "fallback_levels": {
    "_doc": "Escalation when generation fails QC. Each level is tried before moving to next.",
    "0_normal": "Config of the day (1 axis varied). Generate 3-6 seeds.",
    "1_soft": "Same config, different seeds. Generate 3 more.",
    "2_safe": "Studio + Outfit 1 + Accent 1 (all fixed). Generate 3 seeds.",
    "3_library": "Use approved keyframe from library. Zero generation.",
    "4_manual": "Human intervention. Flag for operator review."
  },

  "drift_regression": {
    "_doc": "Weekly regression test to detect model drift.",
    "frequency": "1x per week",
    "config": {"env": "C_studio", "outfit": "1_black_tee", "accent": "1_warm"},
    "seeds": 3,
    "compare_to": "Keyframe Zero",
    "fail_threshold": "2/3 fail identity criterion",
    "on_fail": "Reduce variation axes, increase identity lock strength if available"
  },

  "prebuilt_combos": {
    "_doc": "Ready-to-use daily combos. Pick one, paste blocks in order.",
    "monday_office": {"env": "A_office_a", "outfit": "1_black_tee", "accent": "1_warm"},
    "tuesday_office": {"env": "B_office_b", "outfit": "1_black_tee", "accent": "1_warm"},
    "wednesday_studio": {"env": "C_studio", "outfit": "2_navy_tee", "accent": "2_cool"},
    "thursday_office": {"env": "A_office_a", "outfit": "2_navy_tee", "accent": "1_warm"},
    "friday_casual": {"env": "B_office_b", "outfit": "3_grey_hoodie", "accent": "3_rim"}
  },

  "lipsync_mandatory_phrases": [
    "mouth closed",
    "relaxed lips",
    "clear lip line",
    "clean chin contour",
    "same exact person",
    "same facial structure",
    "looking into camera",
    "hands out of frame"
  ],

  "style_dna_extraction_protocol": {
    "_doc": "When analyzing a reference video/image, extract these 4 outputs.",
    "outputs": [
      "style_dna: 10 bullets (lente, luz, cor, enquadramento, fundo, pele)",
      "do_dont: 10 items (what MUST NOT change)",
      "replicable_prompt: prompt that replicates this style with travas",
      "qc_rubric: what fails QC for this specific style"
    ]
  },

  "naming_convention": {
    "pattern": "Ray_{scene}_{number:02d}.png",
    "examples": ["Ray_OfficeA_01.png", "Ray_OfficeB_03.png", "Ray_Studio_07.png"]
  },

  "keyframe_batch": {
    "_doc": "One-time batch to build keyframe library. Generate 60, keep 12.",
    "generate": 60,
    "distribution": {"A_office_a": 20, "B_office_b": 20, "C_studio": 20},
    "keep": 12,
    "keep_distribution": {"office": 8, "studio": 4},
    "crops_per_keyframe": ["16:9", "9:16", "1:1"]
  }
}
